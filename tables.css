/* tables.css — generator panels (match Skazka theme) */

:root {
  /* Uses your global vars from styles.css; fallback here for safety */
  --sb-panel: var(--sb-panel, #12131a);
  --sb-panel2: var(--sb-panel2, #171922);
  --sb-border: var(--sb-border, #2a2d36);
  --sb-text: var(--sb-text, #e6dccb);
  --sb-dim: var(--sb-dim, #b9b09e);
  --sb-gold: var(--sb-gold, #c2a13a);
  --sb-gold-strong: var(--sb-gold-strong, #e1b84d);
  --sb-radius: var(--sb-radius, 14px);
}

/* === Panel === */
.tb-panel {
  position: relative;
  display: grid;
  gap: 12px;
  background: linear-gradient(180deg, var(--sb-panel), var(--sb-panel2));
  border: 1px solid var(--sb-border);
  padding: clamp(12px, 2vw, 18px);
  color: var(--sb-text);
  box-shadow: 0 12px 24px rgba(0, 0, 0, .45), inset 0 1px 0 rgba(255, 255, 255, .02);
  margin: 18px 0;
  font-size: 1.1rem;
}

.tb-title {
  margin: 0 0 10px;
  color: var(--sb-gold-strong);
  letter-spacing: .3px;
  font-weight: 900;
}

/* === Controls grid === */
.tb-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 10px;
  align-items: end;
}

.tb-label {
  display: flex;
  flex-direction: column;
  gap: 6px;
  font-weight: 800;
  letter-spacing: .2px;
}

/* Inputs/selects/buttons */
.tb-input,
.tb-select {
  width: 100%;
  background: #0f1117;
  color: var(--sb-text);
  border: 1px solid var(--sb-border);
  border-radius: 10px;
  padding: 10px 12px;
  min-height: 42px;
  outline: none;
}

.tb-input:focus,
.tb-select:focus {
  border-color: var(--sb-gold-strong);
  box-shadow: 0 0 0 2px rgba(226, 184, 77, .25);
  background: #10131a;
}

.tb-actions {
  display: flex;
  margin-top: 8px;
  gap: 8px;
  flex-wrap: wrap;
}

.tb-btn {
  background: linear-gradient(180deg, var(--sb-gold-strong), var(--sb-gold));
  color: #0b0a07;
  border: 1px solid color-mix(in oklab, var(--sb-gold) 70%, black);
  margin-top: 4px;
  border-radius: 10px;
  padding: 10px 14px;
  font-weight: 700;
  cursor: pointer;
  transition: transform .06s ease, box-shadow .2s ease, filter .2s ease;
  text-shadow: 0 1px 0 rgba(255, 255, 255, 0.15);
}

.tb-btn:hover {
  filter: brightness(1.05);
  box-shadow: 0 0 0 2px rgba(226, 184, 77, .25), 0 10px 24px rgba(226, 184, 77, .25);
}

.tb-btn:active {
  transform: translateY(1px);
}

.tb-ghost-btn {
  background: transparent;
  color: var(--sb-gold-strong);
  border: 1px solid var(--sb-gold);
  border-radius: 10px;
  padding: 10px 14px;
  cursor: pointer;
  transition: background .2s ease, box-shadow .2s ease;
}

.tb-ghost-btn:hover {
  background: rgba(226, 184, 77, .08);
  box-shadow: inset 0 0 0 1px rgba(226, 184, 77, .18);
}

/* === Result wrappers === */
.tb-result {
  display: block;
  margin-top: 10px;
  padding: 10px 12px;
  border: 1px dashed var(--sb-border);
  border-radius: 10px;
  color: var(--sb-text);
  background: rgba(0, 0, 0, .14);
  white-space: pre-wrap;
  line-height: 1.55;
}

/* Traps: render multi-line nicely */
#trapResult {
  white-space: normal;
}

#trapResult .tb-line {
  margin: 2px 0;
}

#trapResult .tb-label {
  font-weight: 800;
  margin-right: 4px;
}

/* Divider image */
.divider-image {
  display: block !important;
  width: min(680px, 60%);
  height: auto;
  margin: 0 auto clamp(8px, 2.4vw, 20px);
}

/* Lists inside results */
#treasureResult,
#quirkResult {
  white-space: normal;
}

.tb-result ul {
  margin: 6px 0 0 1.1rem;
  padding: 0;
}

.tb-result li {
  margin: 2px 0;
}

/* === Key/Value grid === */
.tb-kv {
  margin: 2px 0;
  display: grid;
  grid-template-columns: minmax(12rem, 22rem) 1fr;
  gap: 6px 12px;
}

.tb-kv .k {
  font-weight: 800;
  margin-right: 6px;
}

/* === Tables === */
.tb-table {
  width: 100%;
  border-collapse: collapse;
  table-layout: fixed;
}

.tb-table thead th {
  text-align: left;
  color: var(--sb-gold-strong);
  font-weight: 900;
}

.tb-table th,
.tb-table td {
  padding: 6px 8px;
  border-bottom: 1px dashed var(--sb-border);
}

.tb-table td {
  vertical-align: top;
}

/* Blueprint detail table: keep cost visible and right-aligned */
#bpDetail .tb-table {
  table-layout: fixed;
  width: 100%;
}

#bpDetail .tb-table col.col-ing {
  width: 60%;
}

#bpDetail .tb-table col.col-qty {
  width: 6ch;
}

#bpDetail .tb-table col.col-unit {
  width: 10ch;
}

#bpDetail .tb-table col.col-badges {
  width: auto;
}


/* shrink-to-content */
#bpDetail .tb-table th.col-cost,
#bpDetail .tb-table td.col-cost {
  text-align: right;
  white-space: nowrap;
  padding-right: 1rem;
}

#bpDetail .tb-table th.col-qty,
#bpDetail .tb-table td.col-qty {
  text-align: center;
}

.tb-table .tb-coins {
  margin-top: 2px;
}

.tb-table .tb-detail-name {
  font: inherit;
  font-weight: 700;
  line-height: 1.25;
  margin: 0 0 2px;
}

.tb-table tbody tr:last-child td {
  border-bottom: 0;
}

/* Segments */
.tb-seg {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
}

.tb-segbtn[aria-pressed="true"] {
  outline: 2px solid var(--sb-gold-strong);
  filter: saturate(1.2) brightness(2);
}

/* Detail header */
.tb-detail-header {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  gap: 8px;
  margin-bottom: 2px;
}

.tb-detail-name {
  font-weight: 700;
  font-size: 1.125rem;
  line-height: 1.2;
}

/* KV (compact variant) */
.tb-kv {
  display: grid;
  gap: 4px;
}

.tb-kv-row {
  display: contents;
  gap: 8px;
  text-align: right;
  opacity: .7;
}

.tb-kv-key {
  width: 40%;
  opacity: .8;
}

.tb-kv-val {
  white-space: pre-wrap;
}

/* Coins */
.tb-coins {
  opacity: .7;
  margin-left: 6px;
  font-size: 12px;
}

.tb-table tbody tr.is-selected {
  filter: brightness(2.0);
}

.tb-table td:nth-child(1) {
  width: 44%;
}

.tb-table td:nth-child(2) {
  width: 26%;
}

.tb-table td:nth-child(3),
.tb-table td:nth-child(4) {
  width: 15%;
}

/* === Shop detail === */
#shopDetail {
  padding: 0;
}

.tb-detail {
  max-width: 56rem;
  margin-inline: auto;
  display: grid;
  gap: 10px;
}

#shopDetail.tb-result {
  padding: 14px;
  background: #161721;
  border-radius: 12px;
}

#shopDetail .tb-detail {
  display: grid;
  gap: 12px;
}

#shopDetail .tb-detail-header {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  gap: 10px;
  flex-wrap: wrap;
}

#shopDetail .tb-detail-name {
  font-weight: 800;
  font-size: 1.25rem;
  line-height: 1.2;
  margin: 0;
}

.tb-detail-desc {
  margin: 2px 0 6px;
  opacity: .9;
}

#shopDetail .tb-badges {
  display: inline-flex;
  gap: 6px;
  flex-wrap: wrap;
}

#shopDetail .tb-kv {
  display: grid;
  grid-template-columns: minmax(140px, 220px) 1fr;
  column-gap: 16px;
  row-gap: 6px;
  align-items: baseline;
}

#shopDetail .tb-kv-row {
  display: contents;
}

#shopDetail .tb-kv-key {
  color: var(--sb-dim);
  font-weight: 700;
  opacity: .9;
}

#shopDetail .tb-kv-val {
  text-align: left;
  font-variant-numeric: tabular-nums;
  white-space: normal;
}

#shopDetail .tb-kv-val .coins {
  display: inline-flex;
  gap: 4px;
  margin-left: 8px;
}

#shopDetail .hr {
  height: 1px;
  margin: 2px 0 6px;
  background: linear-gradient(90deg, transparent, var(--sb-border), transparent);
  border: 0;
}

#shopDetail .tb-detail-desc {
  margin-top: 4px;
  opacity: .94;
  line-height: 1.46;
}

/* ===== SHOP TABLE — 60 / 20 / 20 ===== */
#shopResult {
  display: block;
  padding: 0 !important;
  margin: 0;
  overflow: auto;
  max-height: var(--shop-max, 360px);
  -webkit-overflow-scrolling: touch;
}

#shopResult thead th {
  position: sticky;
  top: 0;
  z-index: 3;
  background: var(--sb-panel, #12131a);
  border-bottom: 1px solid var(--sb-border);
}

#shopResult .tb-table {
  width: 100%;
  border-collapse: collapse;
  table-layout: fixed;
}

#shopResult .tb-table thead th,
#shopResult .tb-table td {
  padding: 6px 8px;
  vertical-align: top;
  line-height: 1.25;
  border-bottom: 1px dashed var(--sb-border);
}

#shopResult .tb-table thead th {
  position: sticky;
  top: 0;
  z-index: 3;
  background: var(--sb-panel, #12131a);
  border-bottom: 1px solid var(--sb-border);
  text-align: left;
  color: var(--sb-gold-strong);
  font-weight: 900;
}

/* Column widths */
#shopResult .tb-table td.col-name {
  width: 60%;
}

#shopResult .tb-table td.col-base {
  width: 20%;
}

#shopResult .tb-table td.col-adjusted {
  width: 20%;
}

/* Price alignment */
#shopResult .tb-table td.col-base,
#shopResult .tb-table td.col-adjusted {
  text-align: left;
  white-space: normal;
  font-variant-numeric: tabular-nums;
}

.nowrap {
  white-space: nowrap;
}

#shopResult .tb-table td.col-base .tb-coins,
#shopResult .tb-table td.col-adjusted .tb-coins {
  display: inline-flex;
  align-items: baseline;
  gap: 4px;
  margin-left: 8px;
  white-space: normal;
}

/* Name + badges on one line */
#shopResult .tb-table .name-line {
  display: flex;
  gap: 8px;
  align-items: baseline;
  flex-wrap: wrap;
}

#shopResult .tb-table .tb-detail-name {
  font: inherit;
  font-weight: 700;
  line-height: 1.22;
  margin: 0;
}

#shopResult .tb-table .tb-badges {
  display: inline-flex;
  gap: 6px;
  flex-wrap: wrap;
}

#shopResult .tb-table tbody tr:last-child td {
  border-bottom: 0;
}

/* === Shop privacy === */
.tb-privacy {
  display: inline-flex;
  align-items: center;
  gap: .5rem;
}

.tb-privacy-label {
  font-size: .9rem;
  opacity: .8;
}

.tb-privacy-status {
  margin-left: .5rem;
  opacity: .75;
}

.tb-privacy-slider {
  width: 72px;
  height: 28px;
  appearance: none;
  background: transparent;
}

/* Track */
.tb-privacy-slider::-webkit-slider-runnable-track {
  height: 28px;
  border-radius: 999px;
  background: linear-gradient(90deg, #3aa655 0 50%, #3aa655 50% 100%);
}

.tb-privacy-slider::-moz-range-track {
  height: 28px;
  border-radius: 999px;
  background: linear-gradient(90deg, #3aa655 0 50%, #3aa655 50% 100%);
}

/* Thumb */
.tb-privacy-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 26px;
  height: 26px;
  border-radius: 50%;
  background: #fff;
  border: 2px solid rgba(0, 0, 0, .15);
  margin-top: 1px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, .2);
}

.tb-privacy-slider::-moz-range-thumb {
  width: 26px;
  height: 26px;
  border-radius: 50%;
  background: #fff;
  border: 2px solid rgba(0, 0, 0, .15);
  box-shadow: 0 1px 2px rgba(0, 0, 0, .2);
}

.tb-privacy-slider:focus-visible {
  outline: 2px solid #4a90e2;
  outline-offset: 2px;
}

/* ===========================
   Forge Cheat Sheet
   =========================== */
#forgeSheet.tb-result {
  padding: 8px 10px;
}

#forgeSheet .forge {
  display: grid;
  gap: 10px;
  line-height: 1.46;
}

#forgeSheet .forge-section {
  display: grid;
  gap: 4px;
}

#forgeSheet .forge-h {
  margin: 2px 0 6px !important;
  font-weight: 900;
  color: var(--sb-gold-strong);
  letter-spacing: .2px;
}

#forgeSheet .forge-p,
#forgeSheet p {
  margin: 0;
  opacity: .92;
  text-align: left !important;
  text-justify: auto !important;
}

#forgeSheet .forge-list {
  margin: 0 !important;
  padding: 0 0 0 1rem !important;
  list-style: disc outside;
  display: grid !important;
  gap: 4px !important;
}

#forgeSheet .forge-list>li {
  margin: 0 !important;
  padding: 0 !important;
  line-height: 1.46;
}

#forgeSheet .forge-grid-2 {
  display: grid;
  grid-template-columns: 1fr;
  column-gap: 16px;
  row-gap: 8px;
  align-items: start;
}

@media (min-width: 960px) {
  #forgeSheet .forge-grid-2 {
    grid-template-columns: 1fr 1fr;
  }
}

#forgeSheet .forge-tools {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  margin-top: 6px;
}

#forgeSheet .forge-tool {
  flex: 1 1 180px;
  border: 1px solid var(--sb-border);
  border-radius: 12px;
  padding-block: 6px;
  padding-inline: 10px;
  background: color-mix(in oklab, var(--sb-panel2) 85%, black);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, .03);
  display: flex;
  flex-direction: column;
  gap: 4px;
}

#forgeSheet .forge-tool-title {
  font-weight: 800;
  margin: 0;
  color: var(--sb-gold-strong);
}

#forgeSheet .forge-tool-desc {
  font-size: .92rem;
  opacity: .88;
  margin: 0;
  text-align: left;
}

#forgeSheet .forge-table {
  width: 100%;
  border-collapse: collapse;
}

#forgeSheet .forge-table thead th {
  font-weight: 900;
}

#forgeSheet .forge-table th,
#forgeSheet .forge-table td {
  padding: 4px 6px;
}

#forgeSheet .forge-table td:first-child,
#forgeSheet .forge-table th:first-child {
  white-space: nowrap;
}

#forgeSheet .forge-table td:nth-child(2),
#forgeSheet .forge-table th:nth-child(2),
#forgeSheet .forge-table td:nth-child(3),
#forgeSheet .forge-table th:nth-child(3) {
  text-align: right;
}

#forgeSheet .hr {
  height: 1px;
  background: linear-gradient(90deg, transparent, var(--sb-border), transparent);
  margin: 4px 0;
  border: 0;
}

#forgeSheet .forge-gen {
  border: 1px solid var(--sb-border);
  border-radius: 12px;
  padding: 10px;
  background: color-mix(in oklab, var(--sb-panel2) 85%, black);
  display: grid;
  gap: 8px;
  align-content: start;
}

#forgeSheet .forge-gen-title {
  font-weight: 900;
  color: var(--sb-gold-strong);
  letter-spacing: .2px;
}

#forgeSheet .forge-gen-buttons {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}

#forgeSheet .forge-chip {
  border: 1px solid var(--sb-gold);
  background: transparent;
  color: var(--sb-gold-strong);
  padding: 6px 10px;
  border-radius: 999px;
  font-weight: 700;
  cursor: pointer;
}

#forgeSheet .forge-chip:hover {
  background: rgba(226, 184, 77, .08);
  box-shadow: inset 0 0 0 1px rgba(226, 184, 77, .18);
}

#forgeSheet .forge-gen-out {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  min-height: 28px;
}

#forgeSheet .forge-pill {
  border: 1px dashed var(--sb-border);
  border-radius: 999px;
  padding: 4px 8px;
  font-size: .92rem;
  opacity: .95;
}

/* Options dropdown */
#preset-list {
  z-index: 20;
  box-shadow: 0 6px 18px rgba(0, 0, 0, .35);
}

#preset-list .tb-option:hover,
#preset-list .tb-option:focus {
  outline: none;
  filter: brightness(1.1);
}

/* NPC — role */
.tb-badge.npc-role {
  background: #5b2c83;
  color: #fff;
  border-color: #e0c8ff;
}

/* NPC — alignment (base + variants) */
.tb-badge.npc-align {
  background: #12151d;
  color: #cfe3ff;
  border-color: #3c6fb8;
}

.tb-badge.npc-align.good {
  background: #2c8a5f;
  color: #fff;
  border-color: #cfe9cf;
}

.tb-badge.npc-align.neutral {
  background: #3b4758;
  color: #cfd3da;
  border-color: #6b707c;
}

.tb-badge.npc-align.evil {
  background: #7e0c23;
  color: #ffe2e2;
  border-color: #d28b99;
}

/* Optional gender variants (if you want them) */
.tb-badge.npc-gender.male {
  background: #1f3a93;
  color: #fff;
  border-color: #8fb2ff;
}

.tb-badge.npc-gender.female {
  background: #7a1f6f;
  color: #fff;
  border-color: #f0b5ff;
}

.tb-badge.npc-race {
  background: #7a1f6f;
  color: #36b761;
  border-color: #068021;
}

/* Humans */
.tb-badge.npc-race.human {
  background: #2c3e50;
  color: #e6eef8;
  border: 1px solid #3b536b;
}

/* Elves */
.tb-badge.npc-race.elf {
  background: #1f5a3c;
  color: #d9f2e3;
  border: 1px solid #2f7a56;
}

/* Dwarves */
.tb-badge.npc-race.dwarf {
  background: #5a3b1f;
  color: #f3e3cf;
  border: 1px solid #7a552f;
}

/* Halflings */
.tb-badge.npc-race.halfling {
  background: #4b2c5e;
  color: #f0e6f7;
  border: 1px solid #6b3f86;
}

/* Gnomes */
.tb-badge.npc-race.gnome {
  background: #2f4a6b;
  color: #e6f0fa;
  border: 1px solid #3f6a9b;
}

/* Half-elf / Half-orc (hyphenated!) */
.tb-badge.npc-race.half-elf {
  background: #244d3f;
  color: #d9f2ea;
  border: 1px solid #31725b;
}

.tb-badge.npc-race.half-orc {
  background: #3c4d24;
  color: #edf6d9;
  border: 1px solid #587231;
}

/* Tieflings */
.tb-badge.npc-race.tiefling {
  background: #5a2130;
  color: #f8dee3;
  border: 1px solid #7a2e43;
}

/* Dragonborn */
.tb-badge.npc-race.dragonborn {
  background: #2a3b6e;
  color: #e4ebfb;
  border: 1px solid #3c57a3;
}

/* (Optional) Kenku, since inns may produce them */
.tb-badge.npc-race.kenku {
  background: #333333;
  color: #f0f0f0;
  border: 1px solid #4a4a4a;
}



/* ===========================
   NPC generator (scoped)
   =========================== */
#npc-controls {
  display: grid;
  grid-template-columns: repeat(2, minmax(260px, 1fr));
  gap: .6rem;
  align-items: start;
}

@media (max-width: 680px) {
  #npc-controls {
    grid-template-columns: 1fr;
  }
}

#npc-panel .tb-combobox {
  position: relative;
  display: block;
}

#npc-panel .tb-combobox .tb-input {
  padding-right: 36px;
}

#npc-panel .tb-input {
  width: 100%;
  display: block;
}

#npc-panel .tb-list {
  position: absolute;
  left: 0;
  right: 0;
  max-height: 240px;
  overflow-y: auto;
  display: none;
  z-index: 20;
  background: #111;
  border: 1px solid rgba(255, 255, 255, .12);
  box-shadow: 0 8px 24px rgba(0, 0, 0, .35);
}

#npc-panel .tb-option {
  padding: .4rem .6rem;
  cursor: pointer;
}

#npc-panel .tb-option:hover,
#npc-panel .tb-option:focus {
  background: rgba(255, 255, 255, .06);
  outline: none;
}

#npc-pretty.tb-result {
  margin: 8px 0 0;
  padding: 8px 10px;
}

#npc-pretty .npc-card {
  line-height: 1.28;
  margin: 0;
}

#npc-pretty .npc-card * {
  box-sizing: border-box;
}

#npc-pretty .npc-card h1,
#npc-pretty .npc-card h2,
#npc-pretty .npc-card h3,
#npc-pretty .npc-card h4,
#npc-pretty .npc-card p,
#npc-pretty .npc-card ul,
#npc-pretty .npc-card li,
#npc-pretty .npc-card blockquote {
  margin: 0;
}

#npc-pretty .npc-header {
  margin-bottom: .22rem;
}

#npc-pretty .npc-name {
  font-weight: 700;
  font-size: 1.06rem;
}

#npc-pretty .npc-tags {
  display: flex;
  flex-wrap: wrap;
  gap: .3rem;
  margin-top: .12rem;
}

#npc-pretty .npc-card .tb-badge {
  padding: .08rem .4rem;
  font-size: .84em;
}

#npc-pretty .npc-meta {
  margin: .12rem 0 .24rem;
}

#npc-pretty .npc-meta .row {
  display: grid;
  grid-template-columns: 120px 1fr;
  column-gap: .6rem;
  align-items: baseline;
  padding: .03rem 0;
}

#npc-pretty .npc-meta .k {
  font-weight: 700;
}

#npc-pretty .npc-hooks {
  margin: .22rem 0 .18rem;
}

#npc-pretty .npc-hooks h4 {
  font-size: .92rem;
  font-weight: 700;
  margin-bottom: .14rem;
}

#npc-pretty .npc-hooks .hooks {
  list-style: disc;
  padding-left: .9rem;
}

#npc-pretty .npc-hooks .hooks li {
  margin: .06rem 0;
  line-height: 1.28;
}

#npc-pretty .npc-opener {
  margin: .26rem 0 0;
  padding: .32rem .56rem;
  border-left: 2px solid currentColor;
  background: rgba(255, 255, 255, .06);
  border-radius: .32rem;
  opacity: .92;
}

#npc-panel #npc-pretty {
  white-space: normal;
  line-height: 1.32;
  margin-top: 8px;
  padding: 8px 10px;
}

#npc-panel #npc-pretty .npc-card {
  line-height: 1.28;
}

#npc-panel #npc-pretty .npc-card h1,
#npc-panel #npc-pretty .npc-card h2,
#npc-panel #npc-pretty .npc-card h3,
#npc-panel #npc-pretty .npc-card h4,
#npc-panel #npc-pretty .npc-card p,
#npc-panel #npc-pretty .npc-card ul,
#npc-panel #npc-pretty .npc-card li,
#npc-panel #npc-pretty .npc-card blockquote {
  margin: 0;
}

#npc-panel #npc-pretty .npc-header {
  margin-bottom: .2rem;
}

#npc-panel #npc-pretty .npc-name {
  font-weight: 700;
  font-size: 1.06rem;
}

#npc-panel #npc-pretty .npc-tags {
  display: flex;
  flex-wrap: wrap;
  gap: .3rem;
  margin-top: .12rem;
}

#npc-panel #npc-pretty .npc-card .tb-badge {
  padding: .08rem .4rem;
  font-size: .84em;
}

#npc-panel #npc-pretty .npc-meta {
  margin: .1rem 0 .22rem;
}

#npc-panel #npc-pretty .npc-meta .row {
  display: grid;
  grid-template-columns: 120px 1fr;
  column-gap: .6rem;
  align-items: baseline;
  padding: .02rem 0;
}

#npc-panel #npc-pretty .npc-meta .k {
  font-weight: 700;
}

#npc-panel #npc-pretty .npc-hooks {
  margin: .2rem 0 .16rem;
}

#npc-panel #npc-pretty .npc-hooks h4 {
  font-size: .92rem;
  font-weight: 700;
  margin-bottom: .12rem;
}

#npc-panel #npc-pretty .npc-hooks .hooks {
  list-style: disc;
  padding-left: .9rem;
}

#npc-panel #npc-pretty .npc-hooks .hooks li {
  margin: .05rem 0;
  line-height: 1.28;
}

#npc-panel #npc-pretty .npc-opener {
  margin: .24rem 0 0;
  padding: .3rem .56rem;
  border-left: 2px solid currentColor;
  background: rgba(255, 255, 255, .06);
  border-radius: .32rem;
  opacity: .92;
}

/* Clear button in inputs */
#npc-panel .tb-combobox .tb-clear {
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  height: 22px;
  width: 22px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border: 0;
  border-radius: 6px;
  background: transparent;
  color: var(--sb-dim);
  cursor: pointer;
  z-index: 21;
  padding: 0;
  line-height: 1;
}

#npc-panel .tb-combobox .tb-clear:hover,
#npc-panel .tb-combobox .tb-clear:focus-visible {
  background: rgba(255, 255, 255, .08);
  color: var(--sb-text);
  outline: none;
}

@supports (-webkit-touch-callout: none) {
  #npc-panel .tb-combobox .tb-clear {
    line-height: 1;
  }
}

/* ===========================
   Treasure — loot lines & coins
   =========================== */
.tb-result .loot-line {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 6px 8px;
  margin: 2px 0 2px 10px;
  line-height: 1.45;
  white-space: normal;
}

.tb-result .loot-line .tb-badges {
  display: inline-flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 8px;
  order: 2;
}

.tb-result .loot-line .coins {
  order: 3;
  margin-left: auto;
}

/* Coin chips */
:root {
  --coin-pp: #b8e3ff;
  --coin-gp: var(--sb-gold-strong, #e1b84d);
  --coin-sp: #c9c9d6;
  --coin-cp: #c88a55;
}

.coins {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  margin-left: 6px;
  font-size: 16px;
  opacity: .95;
  font-variant-numeric: tabular-nums;
}

.coin {
  display: inline-flex;
  align-items: center;
  padding: 1px 6px;
  border-radius: 999px;
  border: 1px solid var(--sb-border);
  background: color-mix(in oklab, var(--sb-panel2) 78%, #000);
  line-height: 1.2;
  letter-spacing: .1px;
}

.coin-pp {
  color: var(--coin-pp);
  border-color: color-mix(in oklab, var(--coin-pp) 50%, #000);
}

.coin-gp {
  color: var(--coin-gp);
  border-color: color-mix(in oklab, var(--coin-gp) 55%, #000);
}

.coin-sp {
  color: var(--coin-sp);
  border-color: color-mix(in oklab, var(--coin-sp) 45%, #000);
}

.coin-cp {
  color: var(--coin-cp);
  border-color: color-mix(in oklab, var(--coin-cp) 45%, #000);
}

.coins-price .coin {
  opacity: .95;
}

.coins-sell .coin {
  opacity: .85;
  filter: saturate(.9);
}

@media (max-width:560px) {
  .tb-result .loot-line .coins {
    margin-top: 2px;
  }
}

/* ===========================
   SHOP — controls layout
   =========================== */
.shop-controls {
  display: grid;
  grid-template-columns: minmax(280px, 1fr) minmax(280px, 1fr) minmax(160px, auto);
  gap: 16px 24px;
  align-items: start;
  margin-bottom: 8px;
}

.shop-controls .col-1,
.shop-controls .col-2 {
  display: grid;
  gap: 10px;
}

.shop-controls .haggle-block {
  display: grid;
  gap: 8px;
}

.shop-controls .col-3 {
  grid-column: 3;
  align-self: end;
  justify-self: end;
}

.tb-coins-toggle {
  display: inline-flex;
  flex-direction: row;
  align-items: center;
  gap: 8px;
  white-space: nowrap;
  margin: 0 0 0 auto;
  justify-self: end;
  align-self: end;
}

.tb-coins-toggle input {
  margin: 0;
}

@media (max-width: 1100px) {
  .shop-controls {
    grid-template-columns: 1fr;
  }

  .shop-controls .col-3 {
    align-self: start;
    justify-self: start;
    margin-top: 4px;
  }
}

/* ===========================
   BLUEPRINTS — list & detail spacing
   =========================== */
#bpResult.tb-result {
  white-space: normal;
  line-height: 1.35;
}

#bpList {
  max-height: 22rem;
  overflow: auto;
  -webkit-overflow-scrolling: touch;
}

#bpList .tb-list {
  margin: 0;
  padding: 0;
  list-style: none;
}

#bpList .tb-list-item {
  display: block;
  padding: .5rem .75rem;
  border-bottom: 1px dashed var(--sb-border);
}

#bpList .tb-list-item:last-child {
  border-bottom: 0;
}

#bpList .tb-list-item[aria-selected="true"] {
  outline: 2px solid var(--sb-gold-strong);
  border-radius: .25rem;
}

#bpDetail.tb-result {
  white-space: normal;
  line-height: 1.35;
}

#bpDetail .tb-kv {
  display: grid;
  grid-template-columns: 140px 1fr;
  gap: 6px 12px;
}

#bpDetail .tb-table th,
#bpDetail .tb-table td {
  padding: 6px 8px;
}

#bpDetail .tb-table col.col-ing {
  width: 34%;
}

#bpDetail .tb-table col.col-qty {
  width: 6ch;
}

#bpDetail .tb-table col.col-unit {
  width: 10ch;
}

#bpDetail .tb-table col.col-badges {
  width: auto;
}


#bpDetail .tb-table th.col-cost,
#bpDetail .tb-table td.col-cost {
  text-align: right;
  white-space: nowrap;
  padding-right: 1rem;
}

#bpDetail .tb-table th.col-qty,
#bpDetail .tb-table td.col-qty {
  text-align: center;
}

/* Make badges visible in treasure lists */
.tb-list .tb-badges {
  display: inline-flex;
  gap: 6px;
  margin-left: .5rem;
  /* space after the name */
  vertical-align: middle;
}

.tb-list .tb-badge {
  display: inline-flex;
  align-items: center;
  padding: 2px 8px;
  border-radius: 999px;
  border: 1px solid var(--badge-border, #444);
  /* pick colors you like, or let type-specific classes override */
  background: var(--badge-bg, rgba(255, 255, 255, .06));
  color: var(--badge-fg, #ddd);
  font-size: .9rem;
}

/* ============================================================
   BADGES — Unified (final)
   ============================================================ */

/* Base pill */
.tb-badge {
  font-size: 14px;
  line-height: 1.15;
  padding: 4px 10px;
  border-radius: 999px;
  border: 1px solid color-mix(in oklab, var(--sb-border) 80%, #000);
  background: color-mix(in oklab, var(--sb-panel2) 85%, #000);
  color: var(--sb-dim);
  text-transform: none;
}

/* One rule for layout */
.tb-badges {
  display: inline-flex;
  gap: 6px;
  flex-wrap: wrap;
  align-items: center;
}

/* Rarity (outline) */
.tb-badge.rarity.common {
  color: #cfd3da;
  border-color: #6b707c;
}

.tb-badge.rarity.uncommon {
  color: #4cc98a;
  border-color: #2c8a5f;
}

.tb-badge.rarity.rare {
  color: #5aa8ff;
  border-color: #3c6fb8;
}

.tb-badge.rarity.very.rare,
.tb-badge.rarity.very_rare,
.tb-badge.rarity.very-rare {
  color: #b888ff;
  border-color: #7a58c9;
}

.tb-badge.rarity.legendary {
  color: #ffb24d;
  border-color: #bf7a1f;
}

.tb-badge.rarity.artifact {
  color: #ff6b6b;
  border-color: #b53f3f;
}

.tb-badge.rarity.unique {
  color: #ffd86b;
  border-color: #b38b2c;
}

/* Attunement / Consumable */
.tb-badge.attune.attune-true {
  background: #fff;
  color: #2e8b57;
  border-color: #2e8b57;
}

.tb-badge.attune.attune-false {
  background: #fff;
  color: #d64545;
  border-color: #d64545;
}

.tb-badge.consumable {
  background: #2c8a5f;
  color: #fff;
  border-color: #fff;
}

/* Publication (SRD only shown) */
.tb-badge.pub.pub-srd {
  background: #fff;
  color: #0f2a5f;
  border-color: #0f2a5f;
}

/* Illicit */
.tb-badge.illicit {
  color: #f2b08b;
  border-color: #a8653b;
}

/* Ingredient types (blueprints detail) */
.tb-badge.herb {
  background: #2e7d32;
  color: #fff;
  border-color: #cfe9cf;
}

.tb-badge.packs {
  background: #8b4dc0;
  color: #fff;
  border-color: #e0c8ff;
}

.tb-badge.containers {
  background: #290746;
  color: #fff;
  border-color: #e0c8ff;
}

.tb-badge.goods {
  background: #290746;
  color: #228bae;
  border-color: #e0c8ff;
}

.tb-badge.art {
  background: #290746;
  color: #20f2d9;
  border-color: #e0c8ff;
}

.tb-badge.ammunition {
  background: #7e0c23;
  color: #20f2d9;
  border-color: #ded3ec;
}

.tb-badge.foci.and.symbols {
  background: #7e0c23;
  color: #20f282;
  border-color: #ded3ec;
}

.tb-badge.poisons {
  background: #1be7a0;
  color: #df113d;
  border-color: #ded3ec;
}

.tb-badge.performing {
  background: #cdf30d;
  color: #df113d;
  border-color: #ded3ec;
}

.tb-badge.mounts {
  background: #574426;
  color: #faf9f9;
  border-color: #ded3ec;
}

.tb-badge.gems,
.tb-badge.gem {
  background: #5b2c83;
  color: #fff;
  border-color: #e0c8ff;
}

.tb-badge.alchemical {
  background: #22577a;
  color: #fff;
  border-color: #bfe6ff;
}

/* Core item types (blue slot look) */
.tb-badge.weapon,
.tb-badge.weapons,
.tb-badge.armor,
.tb-badge.shield,
.tb-badge.ring,
.tb-badge.wand,
.tb-badge.staff,
.tb-badge.rod,
.tb-badge.ammo,
.tb-badge.wondrous {
  background: #2b6cb0;
  color: #fff;
  border-color: #fff;
}

/* Other catalog types (neutral solids; tweak if desired) */
.tb-badge.potion {
  background: #6b46c1;
  color: #fff;
  border-color: #fff;
}

.tb-badge.clothing {
  background: #eeedf1;
  color: #ea14aa;
  border-color: #000000;
}

.tb-badge.tools {
  background: #eeedf1;
  color: #371b2e;
  border-color: #000000;
}

.tb-badge.vehicles {
  background: #eeedf1;
  color: #3324a5;
  border-color: #000000;
}

.tb-badge.scrolls {
  background: #975a16;
  color: #fff;
  border-color: #fff;
}

.tb-badge.tool {
  background: #2c5282;
  color: #fff;
  border-color: #fff;
}

.tb-badge.trade_good {
  background: #805ad5;
  color: #fff;
  border-color: #fff;
}

.tb-badge.gear {
  background: #2d3748;
  color: #fff;
  border-color: #fff;
}

.tb-badge.material {
  background: #22577a;
  color: #fff;
  border-color: #fff;
}

.tb-badge.book,
.tb-badge.map,
.tb-badge.container,
.tb-badge.art_object,
.tb-badge.writing {
  background: rgba(255, 255, 255, .06);
  color: #c9c9d6;
  border-color: #6f6f7a;
}

/* Core reagent roles */
.tb-badge.base {
  background: #394257;
  color: #fff;
  border-color: #fff;
}

/* Substances / materials */
.tb-badge.powder {
  color: #d7c2a3;
  border-color: #8d6a3a;
  background: rgba(120, 90, 40, .18);
}

.tb-badge.metal {
  color: #9bd;
  border-color: #5a7a9a;
  background: rgba(80, 100, 130, .22);
}

.tb-badge.mineral {
  color: #cfe3ff;
  border-color: #466a92;
  background: rgba(30, 60, 90, .20);
}

.tb-badge.glass {
  color: #9bd7ff;
  border-color: #5a9cc6;
  background: rgba(60, 120, 160, .20);
}

.tb-badge.resin {
  color: #f6d07a;
  border-color: #b38b2c;
  background: rgba(80, 60, 20, .22);
}

.tb-badge.wax {
  color: #eedc8a;
  border-color: #b38b2c;
  background: rgba(80, 60, 20, .18);
}

.tb-badge.oil {
  color: #cbbdff;
  border-color: #6b5fb5;
  background: rgba(40, 30, 70, .28);
}

.tb-badge.salt {
  color: #cfe3ff;
  border-color: #466a92;
  background: rgba(30, 60, 90, .20);
}

.tb-badge.carbon {
  color: #8e8e97;
  border-color: #5b5b66;
  background: rgba(50, 50, 60, .22);
}

.tb-badge.ash {
  color: #c9c9d6;
  border-color: #6f6f7a;
  background: rgba(80, 80, 100, .18);
}

.tb-badge.earth {
  color: #d5b08a;
  border-color: #8d6a3a;
  background: rgba(90, 70, 40, .18);
}

/* Organic / biological */
.tb-badge.organic {
  color: #a7d7c9;
  border-color: #2d6b5a;
  background: rgba(20, 80, 60, .22);
}

.tb-badge.moss {
  color: #a7d7c9;
  border-color: #2d6b5a;
  background: rgba(20, 80, 60, .20);
}

.tb-badge.lichen {
  color: #cfe8ff;
  border-color: #5a7ea6;
  background: rgba(40, 80, 110, .16);
}

.tb-badge.silk {
  color: #f1f3f5;
  border-color: #8aa3c0;
  background: rgba(70, 90, 110, .16);
}

.tb-badge.avian {
  color: #cfe3ff;
  border-color: #466a92;
  background: rgba(30, 60, 90, .16);
}

.tb-badge.scale {
  color: #ffcc8a;
  border-color: #a3631d;
  background: rgba(120, 60, 20, .22);
}

.tb-badge.chitin {
  color: #ffcc8a;
  border-color: #a3631d;
  background: rgba(120, 60, 20, .18);
}

.tb-badge.horn {
  color: #d7c2a3;
  border-color: #8d6a3a;
  background: rgba(90, 70, 40, .16);
}

.tb-badge.hoof {
  color: #d7c2a3;
  border-color: #8d6a3a;
  background: rgba(90, 70, 40, .16);
}

.tb-badge.monster_part {
  color: #ffcc8a;
  border-color: #a3631d;
  background: rgba(120, 60, 20, .25);
}

/* Magical / planar themes */
.tb-badge.arcane {
  color: #cbbdff;
  border-color: #6b5fb5;
  background: rgba(40, 40, 80, .22);
}

.tb-badge.essence {
  color: #b888ff;
  border-color: #7a58c9;
  background: rgba(70, 40, 120, .20);
}

.tb-badge.ectoplasm {
  color: #cbbdff;
  border-color: #6b5fb5;
  background: rgba(60, 50, 100, .22);
}

.tb-badge.fey {
  color: #ff9bd7;
  border-color: #a54b7d;
  background: rgba(120, 50, 90, .20);
}

.tb-badge.elemental {
  color: #a6e3ff;
  border-color: #5aa8ff;
  background: rgba(60, 100, 160, .16);
}

.tb-badge.air {
  color: #cfe8ff;
  border-color: #5a9bd6;
  background: rgba(80, 120, 170, .16);
}

.tb-badge.fire {
  color: #e07a3a;
  border-color: #a14a22;
  background: rgba(140, 60, 20, .22);
}

.tb-badge.water {
  color: #8dd3ff;
  border-color: #3d7cab;
  background: rgba(20, 80, 110, .20);
}

.tb-badge.earthy {
  color: #d5b08a;
  border-color: #8d6a3a;
  background: rgba(90, 70, 40, .18);
}

.tb-badge.radiant {
  color: #f0c14b;
  border-color: #b38b2c;
  background: rgba(180, 140, 40, .18);
}

.tb-badge.necrotic {
  color: #cba3ff;
  border-color: #7a58c9;
  background: rgba(60, 40, 90, .26);
}

.tb-badge.frost {
  color: #8dd3ff;
  border-color: #5aa8ff;
  background: rgba(70, 130, 180, .20);
}

.tb-badge.lightning {
  color: #b4d3ff;
  border-color: #6aa0ff;
  background: rgba(60, 90, 160, .20);
}

.tb-badge.time {
  color: #f6e0a0;
  border-color: #b38b2c;
  background: rgba(120, 100, 60, .14);
}

/* Scribing helpers (used elsewhere but handy here too) */
.tb-badge.parchment {
  color: #f6e0a0;
  border-color: #b38b2c;
  background: rgba(80, 70, 40, .22);
}

.tb-badge.ink {
  color: #cbbdff;
  border-color: #6b5fb5;
  background: rgba(40, 40, 80, .28);
}

.tb-badge.reagent {
  color: #ffd86b;
  border-color: #b38b2c;
  background: rgba(22, 66, 38, .22);
  box-shadow: inset 0 0 0 1px rgba(255, 216, 107, .06);
}

/* Herb subtypes / toxin — add styles */
.tb-badge.enhancer {
  color: #9fd0ff;
  border-color: #3c6fb8;
  background: rgba(30, 70, 120, .20);
}

.tb-badge.medicinal {
  color: #a7e3b8;
  border-color: #2d6b5a;
  background: rgba(20, 80, 60, .22);
}

.tb-badge.toxin {
  color: #ff9b9b;
  border-color: #a33;
  background: rgba(140, 30, 30, .18);
}

.tb-badge.extra {
  background: rgba(100, 120, 255, .15);
  border: 1px solid rgba(100, 120, 255, .35);
  color: #c8d0ff;
}

/* INN / SERVICES */
.tb-badge.kind {
  background: #1f2a3a;
  color: #e6f0ff;
  border-color: #5a7ab5;
}

.tb-badge.kind.kind-inn {
  background: #2d3f5e;
}

.tb-badge.tone {
  background: #263244;
  color: #e6f0ff;
  border-color: #5a7ab5;
}

.tb-badge.inn-tag {
  background: #303b49;
  color: #dfe7f2;
  border-color: #6f8dbd;
}

.tb-badge.quality {
  background: #2d2f36;
  color: #e6e6f0;
  border-color: #6b6f7a;
}

.tb-badge.quality.quality-low,
.tb-badge.quality.quality-low-quality {
  background: #4a3a28;
}

.tb-badge.quality.quality-standard,
.tb-badge.quality.quality-standard-quality {
  background: #2d3b4a;
}

tb-badge.quality.quality-high,
.tb-badge.quality.quality-high-quality {
  background: #2c5e4a;
}

.tb-badge.model {
  background: #000000;
  color: #ffffff;
  border-color: #5a728c;
}

.tb-badge.model.model-flat {
  background: #854f4f;
  color: #ffffff;
  border-color: #5a728c;
}

.tb-badge.model.model-per-person {
  background: #867a4e;
  color: #ffffff;
  border-color: #5a728c;
}

.tb-badge.model.model-per-meal {
  background: #7a854c;
  color: #ffffff;
  border-color: #5a728c;
}

.tb-badge.model.model-per-night {
  background: #56834a;
  color: #ffffff;
  border-color: #5a728c;
}

.tb-badge.model.model-per-hour {
  background: #39853c;
  color: #ffffff;
  border-color: #5a728c;
}

.tb-badge.model.model-per-day {
  background: #47817b;
  color: #ffffff;
  border-color: #5a728c;
}

.tb-badge.model.model-per-mile {
  background: #3e5376;
  color: #ffffff;
  border-color: #5a728c;
}

.tb-badge.model.model-per-animal-day {
  background: #433d89;
  color: #ffffff;
  border-color: #5a728c;
}

.tb-badge.model.model-per-page {
  background: #503f76;
  color: #ffffff;
  border-color: #5a728c;
}

.tb-badge.model.model-per-letter {
  background: #5b2d88;
  color: #ffffff;
  border-color: #5a728c;
}

.tb-badge.model.model-per-load {
  background: #a93ca0;
  color: #ffffff;
  border-color: #5a728c;
}

.tb-badge.illicit.tb-badge-warn {
  background: #daac15;
  color: #ffffff;
  border-color: #ffffff;
}

.tb-badge.count {
  background: #1b2230;
  color: #cfe3ff;
  border-color: #3c6fb8;
}

.tb-badge.type {
  background: #1b2230;
  color: #cfe3ff;
  border-color: #3c6fb8;
}


.tb-badge.type.type-inn {
  background: #1b2230;
  color: #c5d816;
  border-color: #3c6fb8;

}

.tb-badge.type.type-personal_services {
  background: #1b2230;
  color: #d88e16;
  border-color: #3c6fb8;
}

.tb-badge.type.type-public_services {
  background: #1b2230;
  color: #eb5a0c;
  border-color: #3c6fb8;
}

.tb-badge.type.type-transport {
  background: #1b2230;
  color: #29d00c;
  border-color: #3c6fb8;
}

.tb-badge.type.type-professional {
  background: #1b2230;
  color: #16d88e;
  border-color: #3c6fb8;
}

.tb-badge.type.type-magical {
  background: #1b2230;
  color: #0fc3ae;
  border-color: #3c6fb8;
}

.tb-badge.type.type-security {
  background: #1b2230;
  color: #0f4bc3;
  border-color: #3c6fb8;
}

.tb-badge.type.type-criminal {
  background: #1b2230;
  color: #f2b08b;
  border-color: #a8653b;
}

.tb-badge.type.type-banking {
  background: #1b2230;
  color: #d96fde;
  border-color: #a8653b;
}

.tb-badge.type.type-bureaucratic {
  background: #1b2230;
  color: #da145d;
  border-color: #a8653b;
}

.tb-badge.yield {
  border: 1px solid #10c7e0;
  background: #222a35;
  color: #dbe7ff;
}

/* ===========================
   Trap layout wrappers
   =========================== */
.trap-header {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: .4rem .5rem;
  margin-bottom: .5rem;
}

.trap-dcs {
  display: flex;
  flex-wrap: wrap;
  gap: .35rem .45rem;
  margin-top: .5rem;
}

/* ===========================
   Color direction you requested
   =========================== */

/* LETHALITY — red scale, white text & border */
.tb-badge.trap-lethality {
  color: #fff;
  border-color: rgba(255, 255, 255, .8);
}

.tb-badge.trap-lethality.lethality-low {
  background: #f87171;
}

/* red-400 */
.tb-badge.trap-lethality.lethality-medium {
  background: #ef4444;
}

/* red-500 */
.tb-badge.trap-lethality.lethality-deadly {
  background: #b91c1c;
}

.tb-badge.trap-dc {
  color: #fff;
  border-color: transparent;
}

.tb-badge.trap-dc.dcv-8 {
  background: #22c55e;
}

/* green-600 */
.tb-badge.trap-dc.dcv-10 {
  background: #65a30d;
}

/* lime-700  */
.tb-badge.trap-dc.dcv-12 {
  background: #84cc16;
}

/* lime-500  */
.tb-badge.trap-dc.dcv-14 {
  background: #eab308;
}

/* yellow-500 */
.tb-badge.trap-dc.dcv-16 {
  background: #f59e0b;
}

/* amber-500  */
.tb-badge.trap-dc.dcv-18 {
  background: #f97316;
}

/* orange-500 */
.tb-badge.trap-dc.dcv-20 {
  background: #ef4444;
}

/* red-500    */
.tb-badge.trap-dc.dcv-22 {
  background: #dc2626;
}

/* red-600    */
.tb-badge.trap-dc.dcv-24 {
  background: #b91c1c;
}

/* red-700    */
.tb-badge.trap-dc.dcv-26 {
  background: #7f1d1d;
}

.tb-badge.trap-env {
  background: #f3c3ec;
  color: #1e3a8a;
  border-color: #bfdbfe;
}

.tb-badge.trap-area {
  background: #ee67da;
  color: #1e3a8a;
  border-color: #bfdbfe;
}

.tb-badge.trap-utility {
  background: #e546cd;
  color: #c3ceee;
  border-color: #bfdbfe;
}

/* TRAP TYPE — blue scale */
.tb-badge.trap-type {
  background: #e0f2fe;
  color: #075985;
  border-color: #7dd3fc;
}

/* sky-100 */
.tb-badge.trap-type.type-mechanical {
  background: #dbeafe;
  color: #1e3a8a;
  border-color: #bfdbfe;
}

/* blue-100 */
.tb-badge.trap-type.type-magical {
  background: #dbeafe;
  color: #1e3a8a;
  border-color: #bfdbfe;
}

/* DAMAGE TYPE — orange scale (unified for all types) */
.tb-badge.trap-dmg {
  background: #fed7aa;
  color: #7c2d12;
  border-color: #fdba74;
}

/* orange-200/300 */

/* SAVE pills stay neutral; DC bar pills are labeled already */
.tb-badge.trap-save {
  background: #f1f5f9;
  color: #0f172a;
  border-color: #cbd5e1;
}

/* Row layout: text left, pills at the end */
.trap-row {
  display: flex;
  flex-wrap: wrap;
  align-items: baseline;
  column-gap: .5rem;
  row-gap: .35rem;
  margin: .15rem 0 .35rem;
}

.trap-row .row-text {
  flex: 1 1 auto;
  min-width: 0;
}

/* <= change to this */
.trap-row .row-pills {
  margin-left: auto;
  flex: 0 1 40%;
  display: inline-flex;
  gap: .35rem;
  flex-wrap: wrap;
  justify-content: flex-end;
}

.trap-footer-pills {
  display: flex;
  flex-wrap: wrap;
  gap: .45rem;
  margin-top: .65rem;
}

.trap-line {
  margin: .25rem 0 .45rem;
  line-height: 1.45;
}

.trap-line b {
  margin-right: .35rem;
}

.trap-line .line-pills {
  display: inline-flex;
  gap: .35rem;
  vertical-align: baseline;
}


/* Small screens: stack pills under the text */
@media (max-width: 720px) {
  .trap-row .row-text {
    flex: 1 0 100%;
    min-width: 0;
  }

  .trap-row .row-pills {
    flex: 1 0 100%;
    justify-content: flex-start;
  }
}

/* encounter badge variants (add to your main stylesheet if desired) */
.tb-badge.enc-zone {
  background: #1e293b;
}

.tb-badge.enc-risk {
  background: #334155;
}

.tb-badge.enc-time {
  background: #475569;
}

.tb-badge.enc-tag {
  background: #6b7280;
}

/* risk severity overrides */
.tb-badge.risk-safe {
  background: #16a34a;
  color: #fff;
}

.tb-badge.risk-low {
  background: #22c55e;
  color: #0b0f0f;
}

.tb-badge.risk-moderate {
  background: #f59e0b;
  color: #111;
}

.tb-badge.risk-high {
  background: #ef4444;
  color: #fff;
}

.tb-badge.risk-deadly {
  background: #991b1b;
  color: #fff;
}


/* ========== Door pills (extend .tb-badge) ========== */
/*challenge*/


.tb-badge.door-chal {
  background: #f6e602ff;
  color: #b23f11ff;
  border-color: #b23f11ff;
}



/* Material */
.tb-badge.door-mat {
  background: #374151;
  color: #F9FAFB;
  border-color: white;
}

/* optional per-material tints */
.tb-badge.mat-softwood {
  background: #065f46;
}

.tb-badge.mat-reinforced-softwood {
  background: #0f766e;
}

.tb-badge.mat-hardwood {
  background: #166534;
}

.tb-badge.mat-reinforced-hardwood {
  background: #14532d;
}

.tb-badge.mat-iron {
  background: #334155;
}

.tb-badge.mat-steel {
  background: #1f2937;
}

.tb-badge.mat-stone {
  background: #4b5563;
}

.tb-badge.mat-adamantine {
  background: #6b21a8;
}

/* Hardness (HP) */
.tb-badge.door-hp {
  background: #1e3a8a;
  color: #F9FAFB;
}

/* Toughness (Break DC) */
.tb-badge.door-breakdc,
.tb-badge.door-lockdc,
.tb-badge.door-pickdc {
  background: #7dd3fc;
  color: #111827;
}

/* tone steps (match your dcToneClass e.g., dcv-8,10,...,26) */
.tb-badge.dcv-8,
.tb-badge.dcv-10 {
  filter: brightness(1.05);
}

.tb-badge.dcv-12,
.tb-badge.dcv-14 {
  filter: brightness(1.0);
}

.tb-badge.dcv-16,
.tb-badge.dcv-18 {
  filter: brightness(0.95);
}

.tb-badge.dcv-20,
.tb-badge.dcv-22 {
  filter: brightness(0.9);
}

.tb-badge.dcv-24,
.tb-badge.dcv-26 {
  filter: brightness(0.85);
}

/* Lock */
.tb-badge.door-lock {
  background: #075985;
  color: white;
  border-color: white;
}

/* lock types */
.tb-badge.lock-std-door-key {
  background: #3f3f46;
}

.tb-badge.lock-padlock {
  background: #4b5563;
}

.tb-badge.lock-deadbolt {
  background: #334155;
}

.tb-badge.lock-combination {
  background: #4c1d95;
}

.tb-badge.lock-puzzle-lock {
  background: #6d28d9;
}

.tb-badge.lock-arcane-seal {
  background: #7c3aed;
}

.tb-badge.lock-obstruction {
  background: #92400e;
}

.tb-badge.lock-no-lock {
  background: #475569;
}

/* Lock quality */
.tb-badge.door-quality {
  background: #52525b;
  color: #F9FAFB;
}

.tb-badge.quality-common {
  background: #6b7280;
}

.tb-badge.quality-sturdy {
  background: #475569;
}

.tb-badge.quality-fine {
  background: #2563eb;
}

.tb-badge.quality-exquisite {
  background: #1d4ed8;
}

.tb-badge.quality-runic {
  background: #7c3aed;
}

/* Locked state + side */
.tb-badge.door-state.state-open {
  background-color: #068021;
  color: white;
  border-color: whitesmoke;
}

.tb-badge.door-state.state-closed-unlocked {
  background-color: greenyellow;
  color: white;
  border-color: whitesmoke;
}

.tb-badge.door-state.state-closed-locked {
  background-color: red;
  color: white;
  border-color: whitesmoke;
}

.tb-badge.door-state.state-ajar {
  background-color: orange;
  color: white;
  border-color: whitesmoke;
}

.tb-badge.door-state.state-obstructed {
  background-color: red;
  color: orange;
  border-color: whitesmoke;
}

.tb-badge.door-lockq {
  background-color: blueviolet;
  color: white;
  border-color: whitesmoke;
}

.tb-badge.door-side {
  background-color: #3562abff;
  color: white;
  border-color: whitesmoke;
}

.tb-badge.door-side {
  background-color: #3562abff;
  color: white;
  border-color: whitesmoke;
}

.tb-badge.door-pick.ok {
  background-color: #3562abff;
  color: white;
  border-color: whitesmoke;
}

.tb-badge.door-hingechip {
  background-color: #3562abff;
  color: white;
  border-color: whitesmoke;
}










.tb-badge.door-hingechip.hinge-noisy .hinge-jammed / .hinge-breaks .tb-badge.door-lockedfrom.side-this-side {
  background: #0f766e;
}

.tb-badge.door-lockedfrom.side-other-side {
  background: #0ea5e9;
}

/* Pickability + Pick DC */
.tb-badge.door-pick.pick-yes {
  background: #0d9488;
  color: #fff;
}


.tb-badge.door-pickdc.pick-impossible {
  background: #7e0c23;
  color: #10c7e0;
}

/* Trap & Damage */
.tb-badge.door-trap.trap-yes {
  background: #b45309;
  color: #fff;
}

/* warn */
.tb-badge.door-trap.trap-no {
  background: #475569;
  color: #F9FAFB;
}

.tb-badge.door-damage.dmg-yes {
  background: #dc2626;
  color: #fff;
}

.tb-badge.door-damage.dmg-no {
  background: #15803d;
  color: #fff;
}



/* ========== Vertical layout helpers (optional) ========== */


.door-bracket {
  opacity: .7;
  padding: 0 .15rem;
}

/* Vertical door layout */
.door-vertical .door-line {
  margin: .3rem 0;
}

.door-vertical .door-line .tb-badge {
  margin-right: .25rem;
}

.door-bracket {
  opacity: .7;
  padding: 0 .15rem;
}

/* Put the #doorChallenge select below its label inside the .tb-grid */
#doorChallenge {
  grid-column: 1 / -1;
  /* start at column 1 and span the row → drops beneath label */
  justify-self: start;
  /* align left within the grid */
  margin-top: .25rem;
  /* a little breathing room under the label */
  display: block;
  /* ensures it behaves like a block in case of resets */
  width: min(320px, 100%);
  /* optional: keep it tidy */
}
{
  "schema": "traps.v3",
  "trap_types": ["mechanical", "magical", "environmental"],

  "dc_brackets": {
    "detect": {
      "very_easy": { "min": 5, "max": 9 },
      "easy": { "min": 10, "max": 14 },
      "medium": { "min": 15, "max": 19 },
      "hard": { "min": 20, "max": 24 },
      "very_hard": { "min": 25, "max": 29 }
    },
    "disarm": {
      "easy": { "min": 10, "max": 14 },
      "medium": { "min": 15, "max": 19 },
      "hard": { "min": 20, "max": 24 },
      "very_hard": { "min": 25, "max": 29 }
    },
    "save": {
      "easy": { "min": 10, "max": 14 },
      "medium": { "min": 15, "max": 19 },
      "hard": { "min": 20, "max": 24 },
      "very_hard": { "min": 25, "max": 29 },
      "nearly_impossible": { "min": 30, "max": 30 }
    }
  },

  "damage_by_lethality": {
    "low": ["1d6", "1d8", "2d6", "1d10"],
    "medium": ["2d6", "2d8", "1d12", "2d10", "3d10"],
    "high": ["4d6", "3d8", "2d10", "2d12", "4d8", "6d10", "10d10"]
  },

  "default_damage_type_by_type": {
    "mechanical": "bludgeoning",
    "magical": "fire",
    "environmental": "bludgeoning"
  },

  "damage_type_distribution_by_type": {
    "mechanical": [
      { "type": "bludgeoning", "w": 4 },
      { "type": "piercing", "w": 3 },
      { "type": "slashing", "w": 2 },
      { "type": "thunder", "w": 1 }
    ],
    "magical": [
      { "type": "fire", "w": 3 },
      { "type": "lightning", "w": 2 },
      { "type": "cold", "w": 2 },
      { "type": "force", "w": 2 },
      { "type": "acid", "w": 2 },
      { "type": "necrotic", "w": 1 },
      { "type": "radiant", "w": 1 },
      { "type": "psychic", "w": 1 },
      { "type": "thunder", "w": 1 },
      { "type": "poison", "w": 1 }
    ],
    "environmental": [
      { "type": "bludgeoning", "w": 4 },
      { "type": "poison", "w": 3 },
      { "type": "acid", "w": 2 },
      { "type": "cold", "w": 2 },
      { "type": "fire", "w": 2 },
      { "type": "piercing", "w": 1 }
    ]
  },

  "damage_type_keywords": [
    {
      "type": "piercing",
      "keywords": [
        "spear",
        "dart",
        "needle",
        "spike",
        "arrow",
        "bolt",
        "stinger",
        "thorn",
        "stalactite"
      ]
    },
    {
      "type": "slashing",
      "keywords": [
        "scythe",
        "blade",
        "saw",
        "axe",
        "razor",
        "slicer",
        "guillotine"
      ]
    },
    {
      "type": "bludgeoning",
      "keywords": [
        "hammer",
        "mace",
        "club",
        "block",
        "boulder",
        "ram",
        "crush",
        "piston",
        "collapse",
        "falling"
      ]
    },
    {
      "type": "fire",
      "keywords": [
        "fire",
        "flame",
        "burn",
        "scorch",
        "flare",
        "geothermal",
        "ignition"
      ]
    },
    {
      "type": "cold",
      "keywords": ["ice", "frost", "freezing", "rime", "hail"]
    },
    { "type": "acid", "keywords": ["acid", "corrode", "caustic", "dissolve"] },
    {
      "type": "poison",
      "keywords": [
        "poison",
        "toxin",
        "venom",
        "gas",
        "miasma",
        "spore",
        "fumes"
      ]
    },
    {
      "type": "lightning",
      "keywords": ["lightning", "shock", "electr", "arc"]
    },
    {
      "type": "force",
      "keywords": ["force", "telekinetic", "repulse", "hammer"]
    },
    {
      "type": "thunder",
      "keywords": ["thunder", "sonic", "boom", "concussion"]
    },
    {
      "type": "necrotic",
      "keywords": ["necrotic", "grave", "wither", "siphon", "drain"]
    },
    {
      "type": "radiant",
      "keywords": ["radiant", "holy", "dawn", "sun", "gleam", "brilliance"]
    },
    {
      "type": "psychic",
      "keywords": ["psychic", "mind", "whisper", "scream", "dread"]
    }
  ],

  "save_types": ["DEX", "CON", "STR", "WIS", "INT", "CHA"],

  "areas": [
    { "v": "single target", "w": 4 },
    { "v": "5-ft square", "w": 3 },
    { "v": "10-ft line", "w": 2 },
    { "v": "15-ft cone", "w": 2 },
    { "v": "10-ft radius burst", "w": 3 }
  ],

  "status_effects": [
    {
      "v": "**restrained** until freed (STR check to escape)",
      "tags": ["mechanical", "environmental"],
      "w": 3
    },
    {
      "v": "**blinded** for 1 minute (end each turn, CON save)",
      "tags": ["radiant", "alchemical", "magical"],
      "w": 2
    },
    {
      "v": "**deafened** for 1 minute",
      "tags": ["thunder", "mechanical"],
      "w": 1
    },
    {
      "v": "**frightened** until end of next turn",
      "tags": ["psychic", "necrotic", "magical"],
      "w": 2
    },
    {
      "v": "**knocked prone** and pushed 10 ft",
      "tags": ["force", "bludgeoning", "mechanical"],
      "w": 2
    },
    {
      "v": "**poisoned** for 1 minute (save ends each turn)",
      "tags": ["poison", "environmental"],
      "w": 2
    },
    {
      "v": "**slowed** (speed halved) for 1 minute",
      "tags": ["cold", "mechanical"],
      "w": 1
    }
  ],

  "triggers": [
    {
      "v": "pressure plate",
      "w": 4,
      "counter": [
        "wedging the plate",
        "leaping the square",
        "shimming the piston"
      ]
    },
    {
      "v": "tripwire",
      "w": 3,
      "counter": ["cutting the wire", "stepping over", "weight off the line"]
    },
    {
      "v": "light beam",
      "w": 2,
      "counter": [
        "smoky dust to reveal",
        "mirror to redirect",
        "covering the lens"
      ]
    },
    {
      "v": "arcane proximity",
      "w": 3,
      "counter": ["dispel magic", "lead-lined hood", "silencing the sigil"]
    },
    {
      "v": "sound threshold",
      "w": 1,
      "counter": ["move in silence", "muffle gear", "cast *silence*"]
    }
  ],

  "reset_modes": [
    { "v": "resets after 1 minute", "w": 3 },
    { "v": "manual reset only", "w": 2 },
    { "v": "single-use then inert", "w": 2 }
  ],

  "clues": [
    "hairline seam around a flagstone",
    "soot scoring on the ceiling",
    "a faint glyph visible at an angle",
    "dead insects along the baseboard",
    "unusual airflow or a sudden cold patch"
  ],

  "alarm": {
    "chance_by_type": {
      "mechanical": 0.25,
      "magical": 0.35,
      "environmental": 0.2
    },
    "effects": [
      { "v": "bells ring in nearby corridors", "w": 3 },
      { "v": "an arcane flare marks intruders", "w": 2 },
      { "v": "hidden whistles summon guardians", "w": 2 },
      { "v": "portcullises slam down nearby", "w": 1 }
    ]
  },

  "utility_effects": [
    {
      "t": "floor panels **tilt** into a harmless slide ({area})",
      "tags": ["mechanical", "DEX"]
    },
    {
      "t": "a **locking rune** seals doors ({area})",
      "tags": ["magical", "WIS|INT|CHA"]
    },
    {
      "t": "dense **smoke** fills the space ({area})",
      "tags": ["environmental", "CON"]
    }
  ],

  "effects_by_type": {
    "mechanical": [
      {
        "t": "a spring-loaded **spear rack** erupts from the wall ({area})",
        "tags": ["piercing", "DEX"]
      },
      {
        "t": "interlocking **saw blades** scissor across the corridor ({area})",
        "tags": ["slashing", "DEX"]
      },
      {
        "t": "a descending **crush piston** slams down ({area})",
        "tags": ["bludgeoning", "DEX"]
      },
      {
        "t": "a ceiling **spike net** drops and entangles ({area})",
        "tags": ["piercing", "DEX|STR"]
      }
    ],
    "magical": [
      {
        "t": "a **glyph** detonates in {dtype} energy ({area})",
        "tags": ["force|fire|cold|lightning|radiant|necrotic", "DEX|CON"]
      },
      {
        "t": "an invisible **force hammer** strikes intruders ({area})",
        "tags": ["force", "STR|DEX"]
      },
      {
        "t": "a whisper lattice unleashes a **mind-scream** ({area})",
        "tags": ["psychic", "WIS|INT|CHA"]
      }
    ],
    "environmental": [
      {
        "t": "**barbed vines** lash from masonry ({area})",
        "tags": ["slashing|poison", "STR|DEX"]
      },
      {
        "t": "a spore pod bursts into **miasma** ({area})",
        "tags": ["poison", "CON"]
      },
      {
        "t": "a **frost vent** ices over the floor ({area})",
        "tags": ["cold", "DEX|CON"]
      },
      {
        "t": "a ceiling **rockfall** thunders down ({area})",
        "tags": ["bludgeoning", "DEX"]
      }
    ]
  },

  "env_tags": {
    "tomb": ["necrotic", "radiant"],
    "sewer": ["poison", "acid"],
    "arctic": ["cold", "bludgeoning"],
    "lair": ["poison", "fire"],
    "ruin": ["force", "psychic"]
  }
}
